{% extends 'ecom/customer_base.html' %} {% load widget_tweaks %} {% block content %}

<head>
    <style media="screen">
        body {
            background-color: #ffffff;
        }
        
        a:link {
            text-decoration: none;
        }
        
        .note {
            text-align: center;
            height: 80px;
            background: -webkit-linear-gradient(left, #0072ff, #8811c5);
            color: #fff;
            font-weight: bold;
            line-height: 80px;
        }
        
        .form-content {
            padding: 5%;
            border: 1px solid #ced4da;
            margin-bottom: 2%;
        }
        
        .form-control {
            border-radius: 1.5rem;
        }
        
        .btnSubmit {
            border: none;
            border-radius: 1.5rem;
            padding: 1%;
            width: 20%;
            cursor: pointer;
            background: #005d94;
            color: #fff;
        }
        
        .menu {
            top: 50px;
        }
    </style>


    <script>
        window.onload = function() {
            updateRegions();
            // Restore previous values if present (for validation errors or editing)
            const prevRegion = '{{ customerForm.region.value|escapejs }}';
            const prevCity = '{{ customerForm.city.value|escapejs }}';
            const prevBarangay = '{{ customerForm.barangay.value|escapejs }}';
            if (prevRegion) {
                document.getElementById('region').value = prevRegion;
                updateCities();
                if (prevCity) {
                    document.getElementById('city').value = prevCity;
                    updateBarangays();
                    if (prevBarangay) {
                        document.getElementById('barangay').value = prevBarangay;
                    }
                }
            } else {
                updateCities();
                updateBarangays();
            }
        };

const philippineRegions = [
    { code: 'NCR', name: 'National Capital Region (NCR)' },
    { code: 'CAR', name: 'Cordillera Administrative Region (CAR)' },
    { code: 'R1', name: 'Ilocos Region (Region I)' },
    { code: 'R2', name: 'Cagayan Valley (Region II)' },
    { code: 'R3', name: 'Central Luzon (Region III)' },
    { code: 'R4A', name: 'CALABARZON (Region IV-A)' },
    { code: 'R4B', name: 'MIMAROPA (Region IV-B)' },
    { code: 'R5', name: 'Bicol Region (Region V)' },
    { code: 'R6', name: 'Western Visayas (Region VI)' },
    { code: 'R7', name: 'Central Visayas (Region VII)' },
    { code: 'R8', name: 'Eastern Visayas (Region VIII)' },
    { code: 'R9', name: 'Zamboanga Peninsula (Region IX)' },
    { code: 'R10', name: 'Northern Mindanao (Region X)' },
    { code: 'R11', name: 'Davao Region (Region XI)' },
    { code: 'R12', name: 'SOCCSKSARGEN (Region XII)' },
    { code: 'R13', name: 'Caraga (Region XIII)' },
    { code: 'BARMM', name: 'Bangsamoro (BARMM)' }
];

const philippineCities = {
    'National Capital Region (NCR)': ['Manila', 'Quezon City', 'Makati', 'Taguig', 'Pasig'],
    'CALABARZON (Region IV-A)': ['Calamba', 'Antipolo', 'Lipa', 'Lucena', 'Dasmari√±as'],
    'Central Luzon (Region III)': ['San Fernando', 'Angeles', 'Tarlac City', 'Balanga'],
    'Central Visayas (Region VII)': ['Cebu City', 'Lapu-Lapu', 'Mandaue', 'Dumaguete'],
    'Davao Region (Region XI)': ['Davao City', 'Tagum', 'Panabo', 'Digos'],
    'Western Visayas (Region VI)': ['Iloilo City', 'Bacolod', 'Roxas City'],
    'Ilocos Region (Region I)': ['Laoag City', 'San Fernando City', 'Vigan'],
    'Bangsamoro (BARMM)': ['Cotabato City', 'Marawi City'],
    'Cordillera Administrative Region (CAR)': ['Baguio City', 'Tabuk', 'La Trinidad']
};

const barangays = {
    'Manila': ['Tondo', 'Binondo', 'Ermita', 'San Andres', 'Santa Mesa'],
    'Quezon City': ['Commonwealth', 'Batasan Hills', 'Bagong Silangan', 'Pinyahan', 'Tandang Sora'],
    'Makati': ['Bel-Air', 'Poblacion', 'Bangkal', 'San Antonio', 'Guadalupe Viejo'],
    'Cebu City': ['Banilad', 'Lahug', 'Guadalupe', 'Pardo', 'Talamban'],
    'Davao City': ['Agdao', 'Bangkal', 'Bunawan', 'Talomo', 'Toril'],
    'Iloilo City': ['Jaro', 'Mandurriao', 'Lapuz', 'La Paz', 'Molo'],
    'Baguio City': ['Asin Road', 'Aurora Hill', 'Burnham-Legarda', 'Camp 7', 'Loakan Proper'],
    'Calamba': ['Canlubang', 'Halang', 'Paciano Rizal', 'Parian', 'Lecheria'],
    'Antipolo': ['San Jose', 'Dela Paz', 'Cupang', 'Dalig', 'Bagong Nayon'],
    'San Fernando': ['Sindalan', 'San Agustin', 'Sto. Rosario', 'Maimpis', 'Del Pilar']
};


        function updateRegions() {
            const regionSelect = document.getElementById('region');
            regionSelect.innerHTML = '<option value="">Select Region</option>';
            philippineRegions.forEach(region => {
                const option = document.createElement('option');
                option.value = region.code;
                option.textContent = region.name;
                regionSelect.appendChild(option);
            });
            updateCities();
        }

        function updateCities() {
            const regionSelect = document.getElementById('region');
            const citySelect = document.getElementById('city');
            const selectedRegionCode = regionSelect.value;
            // Find the region name from the code
            const regionObj = philippineRegions.find(r => r.code === selectedRegionCode);
            const regionName = regionObj ? regionObj.name : '';
            citySelect.innerHTML = '<option value="">Select City</option>';
            const cities = philippineCities[regionName] || [];
            cities.forEach(city => {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            });
            updateBarangays();
        }

        function updateBarangays() {
            const citySelect = document.getElementById('city');
            const barangaySelect = document.getElementById('barangay');
            const selectedCity = citySelect.value;
            
            barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
            
            const cityBarangays = barangays[selectedCity] || [];
            cityBarangays.forEach(barangay => {
                const option = document.createElement('option');
                option.value = barangay;
                option.textContent = barangay;
                barangaySelect.appendChild(option);
            });
        }
    </script>
</head>
<br><br><br><br><br><br>

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-success" style="margin: 0 auto; width: 50%;">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="container register-form">
        <div class="form">
            <div class="note">
                <p>EDIT PROFILE</p>
            </div>
            <div class="form-content">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            {% render_field userForm.first_name class="form-control" placeholder="First Name" %}
                        </div>
                        <div class="form-group">
                            {% render_field userForm.last_name class="form-control" placeholder="Last Name" %}
                        </div>
                        <div class="form-group">
                            {% render_field userForm.username class="form-control" placeholder="Username" %}
                        </div>
                        <div class="form-group">
                            {% render_field userForm.password class="form-control" placeholder="Password" %}
                        </div>
                        <div class="form-group">
                            {% render_field userForm.confirm_password class="form-control" placeholder="Confirm Password" %}
                        </div>
                        <div class="form-group">
                            {% render_field customerForm.street_address class="form-control" placeholder="Street Address" %}
                        </div>
                        <div class="form-group">
                            {% render_field customerForm.postal_code class="form-control" placeholder="Postal Code" %}
                        </div>
                        <div class="form-group">
                            {% render_field customerForm.mobile class="form-control" placeholder="Mobile" %}
                        </div>
                        <div class="form-group">
                            <!-- Replace the country select with region select -->
                            <div class="form-group">
                                {% render_field customerForm.region class="form-control" id="region" onchange="updateCities()" %}
                            </div>
                        </div>
                        <div class="form-group">
                            {% render_field customerForm.city class="form-control" id="city" onchange="updateBarangays()" %}
                        </div>
                        <div class="form-group">
                            {% render_field customerForm.barangay class="form-control" id="barangay" %}
                        </div>
                    </div>

                    </div>
                </div>
                <div>
                    <center><button type="submit" class="btnSubmit">Save</button></center>
                </div>
            </div>
        </div>
    </div>
</form>

{% endblock content %}