{% extends 'ecom/admin_base.html' %}
{% load static %}

{% block content %}
<main class="p-4 sm:p-6 lg:p-8">
    <div class="mb-6">
        <a href="{% url 'admin-view-users' %}" class="text-blue-600 hover:text-blue-900 mb-4 inline-block">
            &larr; Back to Users
        </a>
        <h1 class="text-3xl font-bold text-gray-900">{{ customer.get_name }}</h1>
        <p class="text-gray-600">User profile and account management</p>
    </div>

    <div class="mb-6 border-b border-gray-200">
        <nav class="flex space-x-4" aria-label="Tabs">
            <a href="#profile" class="tab-link px-3 py-2 font-medium text-sm text-blue-600 border-b-2 border-blue-600" onclick="showTab(event, 'profile')">Profile</a>
            <a href="#wallet" class="tab-link px-3 py-2 font-medium text-sm text-gray-500 hover:text-gray-700" onclick="showTab(event, 'wallet')">Wallet</a>
            <a href="#transactions" class="tab-link px-3 py-2 font-medium text-sm text-gray-500 hover:text-gray-700" onclick="showTab(event, 'transactions')">Transactions</a>
            <a href="#security" class="tab-link px-3 py-2 font-medium text-sm text-gray-500 hover:text-gray-700" onclick="showTab(event, 'security')">Security</a>
        </nav>
    </div>

    <div id="profile" class="tab-content">
        <h2 class="text-xl font-semibold mb-4">Profile Information</h2>
        <div class="space-y-2 text-sm">
            <div><strong>Name:</strong> {{ customer.get_name }}</div>
            <div><strong>Email:</strong> {{ customer.user.email }}</div>
            <div><strong>Phone:</strong> {{ customer.mobile }}</div>
            <div><strong>Address:</strong> {{ customer.get_full_address }}</div>
            <div><strong>Status:</strong> {{ customer.status }}</div>
        </div>
    </div>

    <div id="wallet" class="tab-content hidden">
        <h2 class="text-xl font-semibold mb-4">Wallet Information</h2>
        <p>Wallet details and balance can be shown here.</p>
    </div>

    <div id="transactions" class="tab-content hidden">
        <h2 class="text-xl font-semibold mb-4">Transaction History</h2>
        {% if transactions %}
            <ul class="space-y-4">
                {% for txn in transactions %}
                <li class="p-4 border rounded-md flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center justify-center w-10 h-10 rounded-full bg-gray-100 text-gray-700 font-semibold text-lg">
                            {{ txn.product_name|slice:":1" }}
                        </div>
                        <div>
                            <div class="font-medium">{{ txn.product_name }}</div>
                            <div class="text-sm text-gray-500">{{ txn.order_date }}</div>
                            <div class="text-sm text-gray-400">Reference: {{ txn.order_ref }}</div>
                        </div>
                    </div>
                    <div class="font-semibold {% if txn.status == 'Delivered' %}text-green-600{% else %}text-red-600{% endif %}">
                        {% if txn.status == 'Delivered' %}
                            +R {{ txn.amount|floatformat:2 }}
                        {% else %}
                            -R {{ txn.amount|floatformat:2 }}
                        {% endif %}
                    </div>
                </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No transactions found.</p>
        {% endif %}
    </div>

    <div id="security" class="tab-content hidden">
        <h2 class="text-xl font-semibold mb-4">Security Settings</h2>
        <p>Security related settings can be managed here.</p>
    </div>
</main>

<script>
    function showTab(event, tabId) {
        event.preventDefault();
        document.querySelectorAll('.tab-content').forEach(tab => {
            tab.classList.add('hidden');
        });
        document.querySelectorAll('.tab-link').forEach(link => {
            link.classList.remove('border-blue-600', 'text-blue-600');
            link.classList.add('text-gray-500');
        });
        document.getElementById(tabId).classList.remove('hidden');
        event.currentTarget.classList.add('border-blue-600', 'text-blue-600');
    }
</script>
{% endblock %}
